<htlml>
<head>
  <base href='http://partiallyattended.com'>
  
  <link rel='canonical' href='http://partiallyattended.com/2018/04/19/python_-_running_commands_from_within_a_directory_/'>
  <link href='' rel='alternate' type='application/rss+xml' title='Partially Attended' />
  <link rel='stylesheet' href="http://partiallyattended.com/css/styles.css" > 

</head>
</body>
<h2><a href="http://partiallyattended.com">home</a> |
  <a href="http://partiallyattended.com/categories">tags</a> |
  
  
  <a href="http://mulvany.net">mulvany.net</a></h2>
<hr/>


<article id="content">

<h1 class="post-title">python - running commands from within a directory</h1>

<section>
      <h4 id="date"> Thu Apr 19, 2018 </h4>
      <h5 id="wordcount"> 77 Words </h5>
</section>

<div class="post-entry-tags">
                          Tags:
                           <a href="/categories/asilearn">asilearn</a>, <a href="/categories/python">python</a>
</div>

<div>
          <p>A neat python snippet for jumping into a directory, running a script, and jumping out again, found on Stackoverflow, provided by <a href="https://stackoverflow.com/users/19212/brian-m-hunt">Brian Hunt.</a></p>
<div class="highlight" style="background: #272822"><pre style="line-height: 125%"><span></span><span style="color: #f92672">from</span> <span style="color: #f8f8f2">subprocess</span> <span style="color: #f92672">import</span> <span style="color: #f8f8f2">Popen,</span> <span style="color: #f8f8f2">PIPE</span>
<span style="color: #f92672">import</span> <span style="color: #f8f8f2">os</span>
<span style="color: #f92672">import</span> <span style="color: #f8f8f2">sys</span>

<span style="color: #66d9ef">class</span> <span style="color: #a6e22e">cd</span><span style="color: #f8f8f2">:</span>
  <span style="color: #e6db74">&quot;&quot;&quot;Context manager for changing the current working directory</span>
<span style="color: #e6db74">  see https://stackoverflow.com/questions/431684/how-do-i-cd-in-python</span>
<span style="color: #e6db74">  &quot;&quot;&quot;</span>
  <span style="color: #66d9ef">def</span> <span style="color: #a6e22e">__init__</span><span style="color: #f8f8f2">(self,</span> <span style="color: #f8f8f2">newPath):</span>
    <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">newPath</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">os</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">path</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">expanduser(newPath)</span>

  <span style="color: #66d9ef">def</span> <span style="color: #a6e22e">__enter__</span><span style="color: #f8f8f2">(self):</span>
  <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">savedPath</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">os</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">getcwd()</span>
    <span style="color: #f8f8f2">os</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">chdir(self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">newPath)</span>

  <span style="color: #66d9ef">def</span> <span style="color: #a6e22e">__exit__</span><span style="color: #f8f8f2">(self,</span> <span style="color: #f8f8f2">etype,</span> <span style="color: #f8f8f2">value,</span> <span style="color: #f8f8f2">traceback):</span>
    <span style="color: #f8f8f2">os</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">chdir(self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">savedPath)</span>

<span style="color: #66d9ef">with</span> <span style="color: #f8f8f2">cd(</span><span style="color: #e6db74">&quot;~/blog/partiallyattended&quot;</span><span style="color: #f8f8f2">):</span>
  <span style="color: #f8f8f2">title</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">new_post</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">title</span>
  <span style="color: #f8f8f2">process</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">subprocess</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">call([</span><span style="color: #e6db74">&quot;git&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;commit&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;-m&quot;</span><span style="color: #f8f8f2">,</span><span style="color: #e6db74">&quot;`new post: `&quot;</span><span style="color: #f92672">+</span><span style="color: #f8f8f2">title],</span> \
  <span style="color: #f8f8f2">stdout</span><span style="color: #f92672">=</span><span style="color: #f8f8f2">subprocess</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">PIPE)</span>
</pre></div>

 </div>
 </article>



</body>
</html>

